# starbot-mysql-plugins

#### 更新日志

2025年1月17日：

1. mysql数据源将text替换为longtext,原因是text不足以容纳base64字符串长度
2. 完善了setmessage命令的功能，现在他能正确识别图片和at元素并替换成相应占位符了

2025年1月19日：
1. 设置版本号以方便进行版本更新
2. 统一使用命令交互进行设置立绘，并同步了setlogo的相关帮助

2025年1月21日：
1. 更新版本v1.0.1
2. 优化了setmessage的帮助信息，增加了等待超时时间(60s -> 600s)
3. 修正了transdatasource的帮助信息，数据源转换功能不局限于json数据源，可以是任意不为mysql的数据源
4. 增强了list功能，现在能展示对应订阅信息的具体订阅内容，如动态，开播和下播

2025年2月1日：
1. 更新版本v1.0.2
2. 新增quit指令，bot主人私聊和群聊可用，作用为退出群聊并清除订阅

2025年2月15日：
1. 更新版本v1.0.3
2. 增强命令可用性，命令“设置推送信息”增加触发“设置推送消息”，命令“退出群聊”增加触发“退群”
3. 命令交互场景增加了取消功能，发送取消即可取消操作
4. 修正部分日志打印

2025年2月16日：
1. 更新版本v1.0.4
2. 增强命令可用性，命令“添加订阅”增加触发“新增订阅”，命令“删除订阅”增加触发“取消订阅”
3. 重构部分代码逻辑，彻底解决日志打印信息不准确的问题
4. 删除订阅时能够正确的取消关注，可以缓解b站账号关注数量溢出的问题

2025年2月17日：
1. 代码格式优化
2. 修正数据源转换错误导致失败时消息回复的一个bug

2025年2月18日：
1. 优化查询订阅功能在text mode和日志打印下没有去除多余空格和指标符导致的格式混乱和不对齐问题
2. 由于不影响正常功能使用，版本号不更新

2025年3月11日：
1. 更新版本v1.0.5
2. 新增功能 设置直播报告 可用于设置直播报告具体选项，例如 “设置直播报告 2 弹幕词云 开启”或者 “设置直播报告 2 danmu_cloud on”均可
3. 修正默认添加atall标签时，若atall失败自动删除时多出的一个换行符，需要重新设置atall生效
4. 添加订阅帮助信息添加atall存在总次数限制的提示

2025年3月14日：
1. 更新版本v1.0.6
2. 优化命令“查询订阅”功能参数，从“-t true”或“--text true”优化为“-t”和“--text”，同步修改帮助文档
3. 代码格式化

2025年3月15日：
1. 本次不更新版本号
2. 修补问题场景：当up修改昵称时，starbot内存中的up对象仍然为旧昵称，推送会出现昵称不同步的情况。
	新增机制：每次从数据库中重载时，均会更新内存中up对象的uname以保持同步，或者主人可以调用“reloaduid”命令重载，即可同步更新内存
	该修补仅为插件修补问题的简单方法，开发者认为并非根本解决方案

2025年3月18日：
1. 更新版本v1.0.7
2. 命令“查询订阅”功能放弃空格对齐，添加up正在直播的显示“※直播中※”，需要该up主开启直播推送
3. 优化部分命令反馈

2025年3月21日：
1. 更新版本v1.0.8
2. 帮助命令覆盖starbot默认help，添加参数“-d”或“--default”展示默认帮助
3. 优化帮助显示

2025年3月22日：
1. 更新版本v1.0.9
2. 新增私聊ping命令，优化其他命令触发和命令帮助

2025年4月4日：
1. 本次不更新版本号
2. 修复帮助命令触发时at条件不满足时未阻断原始帮助命令解析的逻辑错误

2025年4月6日：
1. 本次不更新版本号
2. 修复list命令在查询开启直播推送但是未开通的up主直播状态时会报错

2025年4月6日：
1. 新增mysql数据源初始化脚本，作用是创建数据库并生成表结构，表结构中预存一条无用订阅指令以解决starbot无法在没有订阅信息的情况下启动的问题。
    请注意，该脚本会导致已存在的starbot表被覆盖，请谨慎执行
	用法示例：python mysql_init.py --qq 123456789 --host 127.0.0.1 --password 123456 --database starbot
	完整用法请使用python mysql_init.py -h获取帮助


2025年4月9日：
1. 更新版本v1.1.0
2. 添加命令“模式”或“mode”，可以设置bot公开模式或私人模式
	公开模式将自动通过所有好友申请和群聊邀请，私人模式拒绝除主人之外的所有好友申请和群聊邀请
	私人模式下，群人数较少等情况下加群邀请会自动同意，因此存在无法拒绝加群邀请的情况
